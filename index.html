<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OMR Command Center | Industrial OMR Sheet Generator</title>
    
    <meta name="description" content="Free industrial-grade OMR Sheet Generator. Create customizable, scanner-readable Optical Mark Recognition sheets with barcode, QR code, and variable data fields.">
    <meta name="keywords" content="OMR Generator, Optical Mark Recognition, Bubble Sheet Creator, Exam Sheet Maker, Cloudflare OMR">
    <meta name="author" content="OMR Command Center">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        cyber: {
                            bg: '#050505',
                            panel: '#0a0a0f',
                            cyan: '#00f0ff',
                            purple: '#7000ff',
                            text: '#e2e8f0'
                        },
                        omr: {
                            red: '#ff003c', // Dropout color
                            black: '#000000'
                        }
                    },
                    fontFamily: {
                        display: ['Rajdhani', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    }
                }
            }
        }
    </script>

    <style>
        /* Custom Scrollbar for Cyber Look */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #050505; }
        ::-webkit-scrollbar-thumb { background: #00f0ff; border-radius: 4px; }

        /* A4 Paper Physics */
        .a4-sheet {
            width: 210mm;
            min-height: 297mm; /* Allow expansion if content is huge, but standard is 297 */
            background: white;
            color: #ff003c; /* Default Dropout Color */
            position: relative;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
            font-family: 'Arial', sans-serif; /* Standard readable font for paper */
            overflow: hidden;
            box-sizing: border-box;
            transform-origin: top center;
        }

        /* OMR Specific Elements */
        .fiducial {
            position: absolute;
            width: 40px;
            height: 40px;
            border-color: black;
            border-style: solid;
            z-index: 50;
        }
        .fiducial-tl { top: 10mm; left: 10mm; border-width: 5px 0 0 5px; }
        .fiducial-tr { top: 10mm; right: 10mm; border-width: 5px 5px 0 0; }
        .fiducial-bl { bottom: 10mm; left: 10mm; border-width: 0 0 5px 5px; }
        .fiducial-br { bottom: 10mm; right: 10mm; border-width: 0 5px 5px 0; }

        .timing-track {
            position: absolute;
            left: 15mm;
            top: 50mm;
            bottom: 50mm;
            width: 10px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        .track-mark {
            width: 100%;
            height: 4px;
            background: black;
        }

        .bubble {
            width: 18px;
            height: 18px;
            border: 1px solid #ff003c;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
            color: #ff003c;
        }

        .box-input {
            width: 20px;
            height: 25px;
            border: 1px solid #ff003c;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: black;
        }

        /* Print Override */
        @media print {
            body * { visibility: hidden; }
            #preview-container, #preview-container * { visibility: visible; }
            #preview-container { 
                position: absolute; 
                left: 0; 
                top: 0; 
                width: 100%; 
                margin: 0; 
                padding: 0;
            }
            .a4-sheet { 
                transform: none !important; 
                box-shadow: none; 
                margin: 0;
            }
        }
    </style>
</head>
<body class="bg-cyber-bg text-cyber-text font-mono h-screen flex flex-col overflow-hidden">

    <header class="h-16 border-b border-cyber-cyan/30 bg-cyber-panel flex items-center justify-between px-6 shadow-[0_0_15px_rgba(0,240,255,0.2)] z-10">
        <div class="flex items-center gap-3">
            <i class="fa-solid fa-microchip text-cyber-purple text-2xl"></i>
            <h1 class="font-display text-2xl tracking-wider font-bold text-white">OMR <span class="text-cyber-cyan">COMMAND CENTER</span></h1>
        </div>
        <div class="flex gap-4">
            <button onclick="generateOMR()" class="px-4 py-2 bg-transparent border border-cyber-cyan text-cyber-cyan hover:bg-cyber-cyan hover:text-black transition-all font-bold text-sm tracking-widest uppercase rounded-sm">
                <i class="fa-solid fa-rotate-right mr-2"></i>Generate
            </button>
            <button onclick="downloadPDF()" class="px-6 py-2 bg-gradient-to-r from-cyber-purple to-cyber-cyan text-black font-bold text-sm tracking-widest uppercase rounded-sm hover:shadow-[0_0_20px_rgba(0,240,255,0.6)] transition-all">
                <i class="fa-solid fa-file-pdf mr-2"></i>Download PDF
            </button>
        </div>
    </header>

    <main class="flex-1 flex overflow-hidden">
        
        <aside class="w-full md:w-96 bg-cyber-panel border-r border-cyber-cyan/20 flex flex-col overflow-y-auto">
            <div class="p-6 space-y-8">
                
                <div class="space-y-3">
                    <h2 class="font-display text-cyber-purple text-lg border-b border-cyber-purple/30 pb-1">
                        <i class="fa-solid fa-building mr-2"></i>Institute Identity
                    </h2>
                    <div class="grid gap-3">
                        <label class="text-xs text-gray-400">Institute Name</label>
                        <input type="text" id="instName" value="CYBER INSTITUTE OF TECHNOLOGY" class="w-full bg-black border border-gray-700 p-2 text-sm focus:border-cyber-cyan outline-none text-white rounded">
                        
                        <label class="text-xs text-gray-400">Exam Name</label>
                        <input type="text" id="examName" value="NATIONAL ENTRANCE EXAM 2026" class="w-full bg-black border border-gray-700 p-2 text-sm focus:border-cyber-cyan outline-none text-white rounded">
                        
                        <label class="text-xs text-gray-400">Logo URL (Optional)</label>
                        <input type="text" id="logoUrl" placeholder="https://..." class="w-full bg-black border border-gray-700 p-2 text-sm focus:border-cyber-cyan outline-none text-white rounded">
                    </div>
                </div>

                <div class="space-y-3">
                    <h2 class="font-display text-cyber-purple text-lg border-b border-cyber-purple/30 pb-1">
                        <i class="fa-solid fa-id-card mr-2"></i>Data Matrix
                    </h2>
                    <div class="grid grid-cols-2 gap-2 text-xs">
                        <label class="flex items-center space-x-2 cursor-pointer">
                            <input type="checkbox" id="fieldRoll" checked class="accent-cyber-cyan"> <span>Roll No (Grid)</span>
                        </label>
                        <label class="flex items-center space-x-2 cursor-pointer">
                            <input type="checkbox" id="fieldMobile" checked class="accent-cyber-cyan"> <span>Mobile No</span>
                        </label>
                        <label class="flex items-center space-x-2 cursor-pointer">
                            <input type="checkbox" id="fieldGender" checked class="accent-cyber-cyan"> <span>Gender</span>
                        </label>
                        <label class="flex items-center space-x-2 cursor-pointer">
                            <input type="checkbox" id="fieldSet" checked class="accent-cyber-cyan"> <span>Set Code</span>
                        </label>
                        <label class="flex items-center space-x-2 cursor-pointer">
                            <input type="checkbox" id="fieldBooklet" checked class="accent-cyber-cyan"> <span>Booklet No</span>
                        </label>
                        <label class="flex items-center space-x-2 cursor-pointer">
                            <input type="checkbox" id="fieldFather" class="accent-cyber-cyan"> <span>Father's Name</span>
                        </label>
                        <label class="flex items-center space-x-2 cursor-pointer">
                            <input type="checkbox" id="fieldStamp" checked class="accent-cyber-cyan"> <span>Stamp Box</span>
                        </label>
                         <label class="flex items-center space-x-2 cursor-pointer">
                            <input type="checkbox" id="fieldThumb" checked class="accent-cyber-cyan"> <span>Thumb Imp.</span>
                        </label>
                    </div>
                </div>

                <div class="space-y-3">
                    <h2 class="font-display text-cyber-cyan text-lg border-b border-cyber-cyan/30 pb-1">
                        <i class="fa-solid fa-list-ol mr-2"></i>Layout Engine
                    </h2>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="text-xs text-gray-400">Total Questions</label>
                            <input type="number" id="totalQuestions" value="100" min="10" max="200" class="w-full bg-black border border-gray-700 p-2 text-sm focus:border-cyber-cyan outline-none text-white rounded">
                        </div>
                        <div>
                            <label class="text-xs text-gray-400">Columns</label>
                            <select id="layoutCols" class="w-full bg-black border border-gray-700 p-2 text-sm focus:border-cyber-cyan outline-none text-white rounded">
                                <option value="3">3 Columns</option>
                                <option value="4" selected>4 Columns</option>
                                <option value="5">5 Columns</option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <label class="text-xs text-gray-400">Options per Question</label>
                        <div class="flex gap-4 mt-1">
                            <label class="flex items-center space-x-2">
                                <input type="radio" name="opts" value="4" checked class="accent-cyber-cyan"> <span class="text-sm">ABCD (4)</span>
                            </label>
                            <label class="flex items-center space-x-2">
                                <input type="radio" name="opts" value="5" class="accent-cyber-cyan"> <span class="text-sm">ABCDE (5)</span>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="space-y-3">
                    <h2 class="font-display text-cyber-purple text-lg border-b border-cyber-purple/30 pb-1">
                        <i class="fa-solid fa-qrcode mr-2"></i>Machine Codes
                    </h2>
                    <div class="grid gap-3">
                        <label class="text-xs text-gray-400">QR Code Value</label>
                        <input type="text" id="qrValue" value="OMR-2026-X89" class="w-full bg-black border border-gray-700 p-2 text-sm focus:border-cyber-cyan outline-none text-white rounded">
                        <label class="text-xs text-gray-400">Barcode Value</label>
                        <input type="text" id="barValue" value="EXAM-BATCH-A" class="w-full bg-black border border-gray-700 p-2 text-sm focus:border-cyber-cyan outline-none text-white rounded">
                    </div>
                </div>

            </div>
            
            <div class="mt-auto p-6 border-t border-cyber-cyan/20 text-xs text-gray-500">
                <h3 class="font-bold text-gray-300 mb-2">Technical Specs</h3>
                <ul class="list-disc pl-4 space-y-1">
                    <li><strong>Fiducials:</strong> Corner anchors for skew correction.</li>
                    <li><strong>Dropout Color:</strong> #FF003C (Scanner ignores this).</li>
                    <li><strong>Timing Track:</strong> Left-side ladder for row sync.</li>
                </ul>
            </div>
        </aside>

        <section class="flex-1 bg-neutral-900 relative flex items-center justify-center p-10 overflow-auto">
            <div id="scale-wrapper" class="transition-transform duration-300">
                <div id="omr-sheet" class="a4-sheet p-8">
                    
                    <div class="fiducial fiducial-tl"></div>
                    <div class="fiducial fiducial-tr"></div>
                    <div class="fiducial fiducial-bl"></div>
                    <div class="fiducial fiducial-br"></div>
                    
                    <div class="flex justify-between items-start border-b-2 border-omr-red pb-2 mb-4" style="margin-top: 10mm; margin-left: 10mm; margin-right: 10mm;">
                        <div class="flex items-center gap-4">
                            <img id="printLogo" src="" alt="Logo" class="h-16 w-16 object-contain hidden">
                            <div>
                                <h1 id="printInstName" class="text-2xl font-black text-black uppercase tracking-wide">INSTITUTE NAME</h1>
                                <h2 id="printExamName" class="text-lg font-bold text-omr-red">EXAM NAME</h2>
                            </div>
                        </div>
                        <div class="flex flex-col items-end">
                            <div id="qrcode-container"></div>
                        </div>
                    </div>

                    <div class="grid grid-cols-12 gap-4 mb-4" style="padding: 0 10mm;">
                        
                        <div class="col-span-5 text-black text-[10px] leading-tight border border-omr-red p-2">
                            <h3 class="font-bold text-omr-red mb-1">INSTRUCTIONS</h3>
                            <ul class="list-disc pl-3 space-y-1">
                                <li>Use only Blue/Black Ball Point Pen.</li>
                                <li>Darken the bubbles completely.</li>
                                <li>Do not use Whitener or Eraser.</li>
                                <li>Example: <span class="inline-block w-3 h-3 rounded-full bg-black align-middle"></span> Correct <span class="inline-block w-3 h-3 rounded-full border border-omr-red align-middle text-[8px] flex items-center justify-center text-omr-red">X</span> Wrong.</li>
                            </ul>
                            <div class="mt-2 pt-2 border-t border-omr-red flex justify-between">
                                <div>
                                    <span class="block font-bold">Total Score</span>
                                    <div class="border border-omr-red h-6 w-16"></div>
                                </div>
                                <div>
                                    <span class="block font-bold">Negative</span>
                                    <div class="border border-omr-red h-6 w-16"></div>
                                </div>
                            </div>
                        </div>

                        <div class="col-span-7 grid grid-cols-2 gap-2">
                            <div class="col-span-2 border border-omr-red p-1 h-12">
                                <span class="text-[9px] uppercase text-black font-bold block">Candidate Name (In Capital Letters)</span>
                                <div class="w-full h-full"></div> </div>
                            
                            <div id="printFather" class="col-span-2 border border-omr-red p-1 h-12 hidden">
                                <span class="text-[9px] uppercase text-black font-bold block">Father's Name</span>
                                <div class="w-full h-full"></div>
                            </div>

                            <div id="printMobile" class="border border-omr-red p-1 h-12">
                                <span class="text-[9px] uppercase text-black font-bold block">Mobile No.</span>
                            </div>

                            <div class="border border-omr-red p-1 h-12">
                                <span class="text-[9px] uppercase text-black font-bold block">Date of Exam</span>
                                <div class="flex gap-2 mt-1">
                                    <div class="w-6 h-4 border border-omr-red"></div>
                                    <div class="w-6 h-4 border border-omr-red"></div>
                                    <div class="w-10 h-4 border border-omr-red"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="flex gap-4 mb-4" style="padding: 0 10mm;">
                        
                        <div id="printRoll" class="border border-omr-red p-2 flex flex-col items-center">
                            <span class="text-[10px] font-bold text-black mb-1">ROLL NO.</span>
                            <div class="flex gap-1 mb-1">
                                <div class="box-input"></div><div class="box-input"></div><div class="box-input"></div><div class="box-input"></div><div class="box-input"></div><div class="box-input"></div><div class="box-input"></div>
                            </div>
                            <div class="flex gap-1">
                                <div id="roll-bubbles" class="flex gap-1"></div>
                            </div>
                        </div>

                        <div class="flex flex-col gap-2">
                             <div id="printSet" class="border border-omr-red p-2">
                                <span class="text-[10px] font-bold text-black mb-1 block">SET CODE</span>
                                <div class="flex gap-2">
                                    <div class="flex flex-col items-center"><div class="bubble">A</div></div>
                                    <div class="flex flex-col items-center"><div class="bubble">B</div></div>
                                    <div class="flex flex-col items-center"><div class="bubble">C</div></div>
                                    <div class="flex flex-col items-center"><div class="bubble">D</div></div>
                                </div>
                            </div>
                            <div id="printBooklet" class="border border-omr-red p-2 hidden">
                                <span class="text-[10px] font-bold text-black mb-1 block">BOOKLET NO</span>
                                <div class="flex gap-1">
                                    <div class="box-input w-6"></div><div class="box-input w-6"></div><div class="box-input w-6"></div>
                                </div>
                            </div>
                        </div>

                        <div class="flex-1 flex items-center justify-center border border-omr-red bg-white">
                            <svg id="barcode"></svg>
                        </div>
                    </div>

                    <div class="relative" style="padding: 0 10mm;">
                        <div class="absolute left-2 top-0 bottom-0 w-2 flex flex-col justify-between py-2">
                            </div>

                        <div id="questions-container" class="grid w-full h-full border-t border-l border-omr-red">
                            </div>
                    </div>

                    <div class="absolute bottom-12 left-0 w-full px-12 grid grid-cols-4 gap-4">
                        <div class="border-b border-omr-red h-10 flex items-end justify-center pb-1">
                            <span class="text-[10px] text-black">Candidate Sign</span>
                        </div>
                        <div class="border-b border-omr-red h-10 flex items-end justify-center pb-1">
                            <span class="text-[10px] text-black">Invigilator Sign</span>
                        </div>
                        <div id="printStamp" class="border border-omr-red h-16 flex items-center justify-center text-center opacity-50">
                            <span class="text-[10px] text-omr-red">STAMP</span>
                        </div>
                         <div id="printThumb" class="border border-omr-red h-16 flex items-center justify-center text-center opacity-50">
                            <span class="text-[10px] text-omr-red">LEFT THUMB</span>
                        </div>
                    </div>

                </div>
            </div>
        </section>
    </main>

    <script>
        // --- Core Logic ---

        // Helper to create bubbles
        function createBubble(text) {
            return `<div class="bubble cursor-pointer hover:bg-red-100">${text}</div>`;
        }

        // Generate Roll Number Columns
        function generateRollGrid() {
            const container = document.getElementById('roll-bubbles');
            container.innerHTML = '';
            // 7 Columns
            for(let col=0; col<7; col++) {
                let html = '<div class="flex flex-col gap-1">';
                for(let i=0; i<=9; i++) {
                    html += createBubble(i);
                }
                html += '</div>';
                container.innerHTML += html;
            }
        }

        // Generate Questions
        function generateQuestions() {
            const total = parseInt(document.getElementById('totalQuestions').value);
            const cols = parseInt(document.getElementById('layoutCols').value);
            const optsCount = parseInt(document.querySelector('input[name="opts"]:checked').value);
            const container = document.getElementById('questions-container');
            
            // Grid Setup
            container.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;
            container.innerHTML = '';

            const perCol = Math.ceil(total / cols);

            // Generate Columns
            for (let c = 0; c < cols; c++) {
                const colDiv = document.createElement('div');
                colDiv.className = 'border-r border-b border-omr-red p-2';
                
                let start = (c * perCol) + 1;
                let end = Math.min(start + perCol - 1, total);

                for (let q = start; q <= end; q++) {
                    let optsHtml = '';
                    const letters = ['A', 'B', 'C', 'D', 'E'];
                    for (let o = 0; o < optsCount; o++) {
                        optsHtml += createBubble(letters[o]);
                    }

                    const rowHtml = `
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-xs font-bold w-6 text-right mr-2 text-black">${q}</span>
                            <div class="flex gap-2">
                                ${optsHtml}
                            </div>
                        </div>
                    `;
                    colDiv.innerHTML += rowHtml;
                }
                container.appendChild(colDiv);
            }
        }

        // UI Binding & Updates
        function generateOMR() {
            // Text Fields
            document.getElementById('printInstName').innerText = document.getElementById('instName').value;
            document.getElementById('printExamName').innerText = document.getElementById('examName').value;
            
            // Logo
            const logoUrl = document.getElementById('logoUrl').value;
            const logoImg = document.getElementById('printLogo');
            if(logoUrl) {
                logoImg.src = logoUrl;
                logoImg.classList.remove('hidden');
            } else {
                logoImg.classList.add('hidden');
            }

            // Toggles
            const toggle = (id, elId) => {
                const el = document.getElementById(elId);
                document.getElementById(id).checked ? el.classList.remove('hidden') : el.classList.add('hidden');
            };

            toggle('fieldRoll', 'printRoll');
            toggle('fieldMobile', 'printMobile');
            toggle('fieldSet', 'printSet');
            toggle('fieldBooklet', 'printBooklet');
            toggle('fieldFather', 'printFather');
            toggle('fieldStamp', 'printStamp');
            toggle('fieldThumb', 'printThumb');

            // Barcode & QR
            JsBarcode("#barcode", document.getElementById('barValue').value, {
                format: "CODE128",
                lineColor: "#000",
                width: 1.5,
                height: 40,
                displayValue: true
            });

            const qrContainer = document.getElementById('qrcode-container');
            qrContainer.innerHTML = "";
            new QRCode(qrContainer, {
                text: document.getElementById('qrValue').value,
                width: 64,
                height: 64,
                colorDark : "#000000",
                colorLight : "#ffffff",
                correctLevel : QRCode.CorrectLevel.H
            });

            generateRollGrid();
            generateQuestions();
        }

        // PDF Download
        function downloadPDF() {
            const element = document.getElementById('omr-sheet');
            
            // Temporary styles for clean PDF export
            element.style.transform = "scale(1)"; 
            element.style.margin = "0";

            const opt = {
                margin:       0,
                filename:     'omr-sheet.pdf',
                image:        { type: 'jpeg', quality: 0.98 },
                html2canvas:  { scale: 2, useCORS: true },
                jsPDF:        { unit: 'mm', format: 'a4', orientation: 'portrait' }
            };

            html2pdf().set(opt).from(element).save().then(() => {
                // Reset visual scaling after download
                fitToScreen();
            });
        }

        // Fit A4 to Screen (Responsive Logic)
        function fitToScreen() {
            const wrapper = document.getElementById('scale-wrapper');
            const container = wrapper.parentElement;
            const sheetHeight = 1123; // A4 height in px at 96dpi approx
            const sheetWidth = 794; 
            
            const availHeight = container.clientHeight - 80;
            const scale = Math.min(1, availHeight / sheetHeight);
            
            wrapper.style.transform = `scale(${scale})`;
            wrapper.style.transformOrigin = 'top center'; // Important
        }

        // Initialization
        window.addEventListener('resize', fitToScreen);
        window.onload = () => {
            generateOMR();
            fitToScreen();
        };

    </script>
    
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Industrial OMR Generator",
      "applicationCategory": "EducationalApplication",
      "operatingSystem": "All",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      }
    }
    </script>
</body>
</html>
