<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Go Raksha Dal ID Card System</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Tiro+Devanagari+Hindi:ital@0;1&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* === GLOBAL RESET === */
        html, body { 
            margin: 0; padding: 0; width: 100%; 
            background-color: #f0f2f5; 
            font-family: 'Poppins', 'Tiro Devanagari Hindi', sans-serif;
            -webkit-print-color-adjust: exact; print-color-adjust: exact;
        }

        #app-wrapper {
            max-width: 1200px; margin: 0 auto; padding: 20px;
            display: flex; flex-direction: column; align-items: center;
        }

        /* === INPUT SECTION === */
        .controls {
            background: white; padding: 25px; border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            width: 100%; max-width: 400px; margin-bottom: 40px;
            text-align: center;
        }
        .controls h2 { color: #002347; margin-top: 0; font-family: 'Poppins', sans-serif; }
        .input-box { width: 100%; padding: 12px; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; box-sizing: border-box; }
        .btn-action {
            background: #d62d20; color: white; border: none; padding: 12px 25px;
            border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; width: 100%;
            transition: background 0.3s;
        }
        .btn-action:hover { background: #b01c11; }
        #status-msg { margin-top: 10px; font-size: 14px; color: #555; min-height: 20px; }

        /* === PREVIEW AREA === */
        #grid-area { display: flex; flex-direction: column; gap: 30px; align-items: center; width: 100%; }
        .card-preview-row {
            display: flex; flex-wrap: wrap; gap: 30px; justify-content: center;
            background: white; padding: 30px; border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .print-btn-container { width: 100%; display: flex; justify-content: center; margin-top: 20px; }
        .btn-print { background: #002347; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; display: flex; align-items: center; gap: 8px; }

        /* =========================================
           ID CARD CSS (HORIZONTAL ISO ID-1)
           Size: 85.6mm x 54mm
        ========================================= */
        .id-card-wrapper {
            width: 85.6mm; height: 54mm;
            position: relative;
            background: transparent;
            /* 3D effect for preview */
            perspective: 1000px;
        }

        .id-card {
            width: 85.6mm; height: 54mm;
            background: white;
            position: relative;
            overflow: hidden;
            border: 1px solid #ddd;
            border-radius: 3mm;
            box-sizing: border-box;
            font-family: 'Tiro Devanagari Hindi', serif; /* HINDI FONT */
            display: flex; flex-direction: column;
            color: #000;
        }

        /* --- FRONT HEADER --- */
        .h-header {
            height: 14mm;
            background: #fff;
            border-bottom: 1px solid #002347;
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 2mm;
            position: relative; z-index: 5;
        }
        
        .h-logo-left { width: 10mm; height: auto; }
        .h-cow-right { width: 11mm; height: auto; }
        
        .h-titles { flex: 1; text-align: center; display: flex; flex-direction: column; justify-content: center; }
        
        /* Red Main Title */
        .h-title-main { 
            font-size: 10pt; font-weight: 700; color: #d62d20; /* Red */
            line-height: 1.1; white-space: nowrap; margin-top: 1px;
        }
        /* Blue Subtitle */
        .h-title-sub { 
            font-size: 4.5pt; font-weight: 600; color: #002347; /* Blue */
            line-height: 1.1; margin-top: 0.5mm;
        }
        
        /* "Pehchan Patra" Tag */
        .h-tag-top {
            position: absolute; top: 0.5mm; left: 50%; transform: translateX(-50%);
            font-size: 3.5pt; background: #002347; color: white; padding: 0.5px 4px;
            border-radius: 2px; text-transform: uppercase; font-weight: bold;
        }

        /* --- FRONT BODY --- */
        .h-body {
            flex: 1; display: flex;
            padding: 1mm 2mm;
            position: relative;
        }

        /* Left Side: Photo & Sign */
        .h-col-left {
            width: 22mm;
            display: flex; flex-direction: column; align-items: center;
        }
        
        .h-photo-box {
            width: 20mm; height: 24mm;
            border: 1px solid #ccc;
            background: #eee;
            margin-top: 1mm;
            position: relative;
        }
        .h-photo-img { width: 100%; height: 100%; object-fit: cover; }

        /* Stamp overlay on Photo */
        .h-stamp-overlay {
            position: absolute;
            bottom: -4mm; right: -4mm;
            width: 14mm;
            opacity: 0.8;
            mix-blend-mode: multiply;
            transform: rotate(-15deg);
            z-index: 10;
        }

        .h-id-no {
            font-size: 4pt; font-weight: 700; color: #d62d20;
            margin-top: 1mm; text-align: center; line-height: 1;
        }
        
        .h-barcode-box {
            margin-top: auto;
            width: 100%; height: 6mm;
            display: flex; justify-content: center; align-items: flex-end;
        }
        .h-barcode-box svg { height: 100%; width: 100%; }

        /* Right Side: Details */
        .h-col-right {
            flex: 1;
            padding-left: 2mm;
            display: flex; flex-direction: column;
        }

        .h-id-header {
            font-size: 5pt; font-weight: bold; color: #002347;
            border-bottom: 0.5px solid #d62d20; margin-bottom: 1mm;
            display: flex; justify-content: space-between;
        }

        .h-field-grid {
            display: grid;
            grid-template-columns: 16mm 1fr; /* Label width | Value width */
            row-gap: 0.8mm;
            font-size: 5.5pt;
        }
        
        .h-lbl { color: #d62d20; font-weight: 700; } /* Red Labels */
        .h-val { color: #000; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        .h-sign-area {
            position: absolute; bottom: 0; right: 2mm;
            text-align: center;
        }
        .h-sign-img { height: 6mm; width: auto; display: block; margin: 0 auto; }
        .h-sign-lbl { font-size: 4pt; color: #002347; font-weight: 700; border-top: 0.5px solid #000; padding-top: 0.5px; }

        /* --- FRONT FOOTER --- */
        .h-footer {
            height: 4mm;
            background: #002347; /* Blue Background */
            color: white;
            display: flex; align-items: center; justify-content: center;
            font-size: 3.5pt; font-weight: 600;
            text-align: center; line-height: 1.1;
            white-space: pre-wrap;
        }

        /* --- BACK SIDE (Verification) --- */
        .vb-body {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            height: 100%; padding: 3mm; text-align: center;
        }
        .vb-qr-box { width: 25mm; height: 25mm; border: 1px solid #ccc; padding: 1px; margin-bottom: 2mm; }
        .vb-qr-box img { width: 100%; height: 100%; }
        .vb-text { font-size: 7pt; font-weight: bold; color: #002347; margin-bottom: 1mm; }
        .vb-sub { font-size: 5pt; color: #555; width: 80%; }
        
        /* Watermark */
        .bg-watermark {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 30mm; opacity: 0.08; pointer-events: none; z-index: 0;
        }

    </style>
</head>
<body>

<div id="app-wrapper">
    <div class="controls">
        <h2><i class="fa-solid fa-address-card"></i> आईडी कार्ड सत्यापन</h2>
        <input type="text" id="inputId" class="input-box" placeholder="Member ID (e.g. 101)">
        <input type="text" id="inputPhone" class="input-box" placeholder="Phone (e.g. 9053575169)">
        <button class="btn-action" onclick="verifyAndGenerate()">
            <i class="fa-solid fa-check-circle"></i> Verify & Generate
        </button>
        <div id="status-msg">सिस्टम तैयार है...</div>
    </div>

    <div id="grid-area"></div>
</div>

<script>
    // === CONFIGURATION ===
    // Update this URL if your sheet changes
    const EXCEL_FILE_URL = "https://docs.google.com/spreadsheets/d/1p1ynKWyRErPwczTcMkffZfQ7dhOiV9buv_gIVRK3uh0/export?format=csv&gid=85144492";
    
    // Resource URLs
    const ASSETS = {
        logo: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhCaJCRPLvQgi9REoAvb9b4H4Vvh6RhAmMRGwGEolXIqS2nxxCa9-jS7qexF2JL5puwPOEk-2q7ubDKeL-m-BM0_7_uHrI5EnBXue7deGtgta4UyCDnI43AkB1KBN8PV4G00fg1vW2La338AyzZkHvXpzt49papqeYLt9NDXMcTnvsceg/s1600/TYS-White.png",
        cow: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj4jRFVp4bz-d45e1q-rgRwa4yOre7RBcKtS-dxVu9ayVmpGTs8rHNx6M8xnO5zLkvS7_MOU2_l6k5i6J56mN5FymgLK9IE5eIDdfp2aNEB3xmrAHp8YzzRJ-5OZeT0-uRI_eeo3gE-ZQNFK-FuHmr9Cl_gYVVeFE7bHljkejal8S2LBw/s1600/cow-calf-image.jpg",
        stamp: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj72nNAiChUf9ROOPiYDrwg4RSatVygGQEt7yW1lOmQosfBW9MB2V3qZAcYcOHH-0bAb_2QBZSUsL_9xdVIdpZdvVOha0czW1ssESptg8Mg3X6W8K1DuyPio_oh6X4DdNH2xUhRc2fX1AkpJh2RuPYl5b0a16nYSTgGrkQnKuwYvz3lsQ/s1600/Lokesh%20Stamp.jpg",
        sign: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj72nNAiChUf9ROOPiYDrwg4RSatVygGQEt7yW1lOmQosfBW9MB2V3qZAcYcOHH-0bAb_2QBZSUsL_9xdVIdpZdvVOha0czW1ssESptg8Mg3X6W8K1DuyPio_oh6X4DdNH2xUhRc2fX1AkpJh2RuPYl5b0a16nYSTgGrkQnKuwYvz3lsQ/s1600/Lokesh%20Stamp.jpg" // Using stamp as signature placeholder if actual sign column missing
    };

    // Excel Column Mappings (Adjust strictly to your Excel header names)
    const FIELDS = {
        id: "id",
        first: "firstname",
        last: "lastname",
        father: "father_name",
        phone: "phone",
        photo: "photo_url",
        joined: "joined",
        // New fields inferred from prompt
        dob: "dob", 
        address: "address",
        blood: "blood_group"
    };

    let ALL_DATA = [];

    // Initialize
    window.onload = loadData;

    function getProxy(url) {
        if(!url) return "https://via.placeholder.com/150";
        return `https://wsrv.nl/?url=${encodeURIComponent(url)}&output=png`;
    }

    async function loadData() {
        const status = document.getElementById('status-msg');
        status.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> डेटा लोड हो रहा है...';
        
        try {
            const resp = await fetch(EXCEL_FILE_URL + "&t=" + Date.now());
            const buffer = await resp.arrayBuffer();
            const workbook = XLSX.read(new Uint8Array(buffer), {type: 'array', cellDates: true});
            const sheet = workbook.Sheets[workbook.SheetNames[0]];
            ALL_DATA = XLSX.utils.sheet_to_json(sheet);
            status.innerHTML = `<span style="color:green">✅ डेटाबेस कनेक्ट हो गया। (${ALL_DATA.length} सदस्य)</span>`;
        } catch (e) {
            console.error(e);
            status.innerHTML = '<span style="color:red">❌ कनेक्शन विफल। इंटरनेट जांचें।</span>';
        }
    }

    function formatDate(val) {
        if (!val) return "";
        const d = new Date(val);
        if (isNaN(d.getTime())) return val;
        return `${d.getDate().toString().padStart(2,'0')}-${(d.getMonth()+1).toString().padStart(2,'0')}-${d.getFullYear()}`;
    }

    function verifyAndGenerate() {
        const inId = document.getElementById('inputId').value.trim().toLowerCase().replace('tym-',''); // handle if user types prefix
        const inPhone = document.getElementById('inputPhone').value.trim();
        const grid = document.getElementById('grid-area');
        const status = document.getElementById('status-msg');

        if (!inId || !inPhone) {
            status.innerText = "कृपया दोनों विवरण भरें।";
            return;
        }

        const found = ALL_DATA.find(m => {
            const mId = String(m[FIELDS.id]||'').trim();
            const mPh = String(m[FIELDS.phone]||'').trim();
            return mId == inId && mPh.includes(inPhone);
        });

        if (!found) {
            status.innerHTML = '<span style="color:red">❌ सदस्य नहीं मिला या विवरण गलत है।</span>';
            grid.innerHTML = '';
            return;
        }

        status.innerHTML = '<span style="color:green">✅ सत्यापन सफल! कार्ड बन रहा है...</span>';
        renderCard(found);
    }

    function renderCard(data) {
        const grid = document.getElementById('grid-area');
        
        // Prepare Data
        const memID = data[FIELDS.id] || "000";
        const fullID = `TYS-HR-GRD-TYM-${memID}`;
        const name = `${data[FIELDS.first] || ''} ${data[FIELDS.last] || ''}`.trim();
        const father = data[FIELDS.father] || "";
        const phone = data[FIELDS.phone] || "";
        const dob = formatDate(data[FIELDS.dob]) || "________";
        const issueDate = formatDate(data[FIELDS.joined]) || formatDate(new Date());
        const address = data[FIELDS.address] || "गांव खांडा, सोनीपत"; // Default if empty
        const blood = data[FIELDS.blood] || "";
        
        // Images
        const photoUrl = getProxy(data[FIELDS.photo]);
        const logoUrl = getProxy(ASSETS.logo);
        const cowUrl = getProxy(ASSETS.cow);
        const stampUrl = getProxy(ASSETS.stamp);
        
        // Verification Link
        const verifyLink = `https://www.tirangayuvasamiti.org/verify?id=${memID}`;

        const frontId = `cf-${memID}`;
        const backId = `cb-${memID}`;

        grid.innerHTML = `
            <div class="card-preview-row">
                <div>
                    <div style="text-align:center; font-weight:bold; color:#002347; margin-bottom:5px;">FRONT SIDE</div>
                    <div class="id-card-wrapper">
                        <div class="id-card" id="${frontId}">
                            <div class="h-header">
                                <div class="h-tag-top">पहचान पत्र</div>
                                <img src="${logoUrl}" class="h-logo-left" crossorigin="anonymous">
                                <div class="h-titles">
                                    <div class="h-title-main">गो रक्षा दल (हरियाणा)</div>
                                    <div class="h-title-sub">तिरंगा युवा समिति (पंजी. सं. 01820)<br>गांव खांडा, तहसील खरखौदा, सोनीपत (हरियाणा)</div>
                                </div>
                                <img src="${cowUrl}" class="h-cow-right" crossorigin="anonymous">
                            </div>

                            <div class="h-body">
                                <img src="${logoUrl}" class="bg-watermark" crossorigin="anonymous">
                                
                                <div class="h-col-left">
                                    <div class="h-photo-box">
                                        <img src="${photoUrl}" class="h-photo-img" crossorigin="anonymous">
                                        <img src="${stampUrl}" class="h-stamp-overlay" crossorigin="anonymous">
                                    </div>
                                    
                                    <div class="h-barcode-box">
                                        <svg id="bar-${memID}"></svg>
                                    </div>
                                </div>

                                <div class="h-col-right">
                                    <div class="h-id-header">
                                        <span>क्रमांक: ${fullID}</span>
                                    </div>
                                    
                                    <div class="h-field-grid">
                                        <div class="h-lbl">नाम:</div>
                                        <div class="h-val" style="font-size:7pt; color:#002347;">${name}</div>

                                        <div class="h-lbl">पिता का नाम:</div>
                                        <div class="h-val">${father}</div>

                                        <div class="h-lbl">जन्म तिथि:</div>
                                        <div class="h-val">${dob}</div>

                                        <div class="h-lbl">पद:</div>
                                        <div class="h-val" style="background:#d62d20; color:white; padding:0 3px; border-radius:2px; display:inline-block; font-size:5pt;">गोरक्षक</div>

                                        <div class="h-lbl">मोबाइल:</div>
                                        <div class="h-val">${phone}</div>

                                        <div class="h-lbl">पता:</div>
                                        <div class="h-val" style="font-size:4.5pt; line-height:1;">${address}</div>
                                        
                                        <div class="h-lbl">जारी तिथि:</div>
                                        <div class="h-val">${issueDate} &nbsp; <span style="color:#d62d20">B.G:</span> ${blood}</div>
                                    </div>

                                    <div class="h-sign-area">
                                        <img src="${stampUrl}" class="h-sign-img" style="opacity:0;" crossorigin="anonymous"> 
                                        <div class="h-sign-lbl">(अधिकृत हस्ताक्षर)</div>
                                    </div>
                                </div>
                            </div>

                            <div class="h-footer">
                                संपर्क सूत्र: +91 90535 75169 | info@tirangayuvasamiti.org | www.tirangayuvasamiti.org
                            </div>
                        </div>
                    </div>
                </div>

                <div>
                    <div style="text-align:center; font-weight:bold; color:#002347; margin-bottom:5px;">BACK SIDE</div>
                    <div class="id-card-wrapper">
                        <div class="id-card" id="${backId}">
                            <div class="h-header" style="justify-content:center; background:#002347;">
                                <div class="h-title-main" style="color:white;">सत्यापन और नियम</div>
                            </div>
                            <div class="vb-body">
                                <div class="vb-text">सदस्यता सत्यापित करने के लिए स्कैन करें</div>
                                <div id="qr-${memID}" class="vb-qr-box"></div>
                                <div class="vb-sub">
                                    यह कार्ड तिरंगा युवा समिति की संपत्ति है।<br>
                                    गुम होने पर कृपया उपरोक्त पते पर लौटाएं।
                                </div>
                                <div style="margin-top:10px; font-weight:bold; color:#d62d20;">
                                    JAI HIND - JAI BHARAT - JAI GAU MATA
                                </div>
                            </div>
                            <div class="h-footer">
                                Together We Serve • Go Raksha Dal Haryana
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="print-btn-container">
                <button class="btn-print" onclick="printCard('${frontId}', '${backId}')">
                    <i class="fa-solid fa-print"></i> प्रिंट आईडी कार्ड
                </button>
            </div>
        `;

        // Generate Barcode (Front)
        setTimeout(() => {
            JsBarcode(`#bar-${memID}`, memID, {
                format: "CODE128",
                displayValue: false,
                height: 30,
                width: 1.5,
                margin: 0,
                background: "transparent"
            });

            // Generate QR (Back)
            const qrDiv = document.getElementById(`qr-${memID}`);
            new QRCode(qrDiv, {
                text: verifyLink,
                width: 100,
                height: 100
            });
        }, 100);
    }

    // Print Function specific to Horizontal ID Card
    function printCard(fid, bid) {
        const fHtml = document.getElementById(fid).outerHTML;
        const bHtml = document.getElementById(bid).outerHTML;

        const win = window.open('', '', 'width=900,height=600');
        win.document.write(`
            <html>
            <head>
                <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Tiro+Devanagari+Hindi:ital@0;1&display=swap" rel="stylesheet">
                <style>
                    @page { size: 85.6mm 54mm; margin: 0; }
                    body { margin: 0; padding: 0; background: white; -webkit-print-color-adjust: exact; font-family: 'Tiro Devanagari Hindi', serif; }
                    .page-break { page-break-after: always; width: 85.6mm; height: 54mm; position: relative; overflow: hidden; }
                    
                    /* Copy minimal CSS needed for rendering */
                    .id-card { width: 85.6mm; height: 54mm; border: none; position: relative; overflow: hidden; display: flex; flex-direction: column; background:white; }
                    
                    .h-header { height: 14mm; background: #fff; border-bottom: 1px solid #002347; display: flex; align-items: center; justify-content: space-between; padding: 0 2mm; position: relative; z-index: 5; }
                    .h-tag-top { position: absolute; top: 0.5mm; left: 50%; transform: translateX(-50%); font-size: 3.5pt; background: #002347; color: white; padding: 0.5px 4px; border-radius: 2px; text-transform: uppercase; font-weight: bold; }
                    .h-logo-left { width: 10mm; } .h-cow-right { width: 11mm; }
                    .h-titles { flex: 1; text-align: center; }
                    .h-title-main { font-size: 10pt; font-weight: 700; color: #d62d20; line-height: 1.1; margin-top: 1px; white-space: nowrap; }
                    .h-title-sub { font-size: 4.5pt; font-weight: 600; color: #002347; line-height: 1.1; margin-top: 0.5mm; }

                    .h-body { flex: 1; display: flex; padding: 1mm 2mm; position: relative; }
                    .bg-watermark { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 30mm; opacity: 0.1; z-index: 0; }
                    
                    .h-col-left { width: 22mm; display: flex; flex-direction: column; align-items: center; }
                    .h-photo-box { width: 20mm; height: 24mm; border: 1px solid #ccc; position: relative; margin-top: 1mm; }
                    .h-photo-img { width: 100%; height: 100%; object-fit: cover; }
                    .h-stamp-overlay { position: absolute; bottom: -4mm; right: -4mm; width: 14mm; opacity: 0.8; mix-blend-mode: multiply; transform: rotate(-15deg); z-index: 10; }
                    .h-barcode-box { margin-top: auto; width: 100%; height: 6mm; display:flex; justify-content:center; }
                    
                    .h-col-right { flex: 1; padding-left: 2mm; display: flex; flex-direction: column; }
                    .h-id-header { font-size: 5pt; font-weight: bold; color: #002347; border-bottom: 0.5px solid #d62d20; margin-bottom: 1mm; }
                    .h-field-grid { display: grid; grid-template-columns: 16mm 1fr; row-gap: 0.8mm; font-size: 5.5pt; }
                    .h-lbl { color: #d62d20; font-weight: 700; }
                    .h-val { color: #000; font-weight: 600; white-space: nowrap; overflow: hidden; }
                    
                    .h-sign-area { position: absolute; bottom: 0; right: 2mm; text-align: center; }
                    .h-sign-lbl { font-size: 4pt; color: #002347; font-weight: 700; border-top: 0.5px solid #000; padding-top: 0.5px; }
                    
                    .h-footer { height: 4mm; background: #002347; color: white; display: flex; align-items: center; justify-content: center; font-size: 3.5pt; font-weight: 600; text-align: center; line-height: 1.1; }

                    /* Back Side specifics */
                    .vb-body { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; padding: 3mm; text-align: center; }
                    .vb-qr-box { width: 25mm; height: 25mm; border: 1px solid #ccc; padding: 1px; margin-bottom: 2mm; }
                    .vb-qr-box img { width: 100%; height: 100%; }
                    .vb-text { font-size: 7pt; font-weight: bold; color: #002347; }
                    .vb-sub { font-size: 5pt; color: #555; }
                </style>
            </head>
            <body>
                <div class="page-break">${fHtml}</div>
                <div class="page-break">${bHtml}</div>
            </body>
            </html>
        `);
        win.document.close();
        setTimeout(() => {
            win.focus();
            win.print();
            setTimeout(() => win.close(), 1000);
        }, 1000);
    }
</script>
</body>
</html>
